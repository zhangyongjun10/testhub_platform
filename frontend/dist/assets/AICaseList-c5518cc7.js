import{_ as J,u as G,q as i,V as S,x as K,r as s,S as O,o as A,c as Q,b as p,d as t,w as o,N as W,J as X,e as u,g as C,U as Y,af as Z,f as g,ae as ee,H as te,E as ae}from"./index-054e2682.js";import{a1 as oe,a2 as le,a3 as ne,a4 as se}from"./ui_automation-53e326f9.js";const re={class:"page-container"},ie={class:"card-container"},de={class:"filter-bar"},ue={class:"pagination-container"},ce={class:"dialog-footer"},pe={__name:"AICaseList",setup(_e){const U=G(),V=i([]),y=i(!1),w=i(""),h=i(0),r=S({currentPage:1,pageSize:20}),_=i(!1),b=i(!1),z=i(null),n=S({name:"",description:"",task_description:""}),k=i(null),B={name:[{required:!0,message:"请输入用例名称",trigger:"blur"}],task_description:[{required:!0,message:"请输入任务描述",trigger:"blur"}]},c=async()=>{y.value=!0;try{const l=await oe({page:r.currentPage,page_size:r.pageSize,search:w.value});V.value=l.data.results||[],h.value=l.data.count||0}catch(l){console.error("获取用例列表失败:",l),u.error("获取用例列表失败")}finally{y.value=!1}},P=()=>{r.currentPage=1,c()},E=()=>{r.currentPage=1,c()},D=()=>{c()},L=l=>{z.value=l.id,n.name=l.name,n.description=l.description,n.task_description=l.task_description,_.value=!0},N=async()=>{k.value&&await k.value.validate(async l=>{if(l){b.value=!0;try{await le(z.value,{name:n.name,description:n.description,task_description:n.task_description}),u.success("更新成功"),_.value=!1,c()}catch(e){console.error("更新失败:",e),u.error("更新失败")}finally{b.value=!1}}})},R=async l=>{try{await ae.confirm("确定要删除该用例吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await ne(l),u.success("删除成功"),c()}catch(e){e!=="cancel"&&(console.error("删除失败:",e),u.error("删除失败"))}},T=async l=>{try{await se(l.id),u.success("用例开始执行"),U.push("/ai-intelligent-mode/execution-records")}catch(e){console.error("执行失败:",e),u.error("执行失败")}},$=(l,e,d)=>d?new Date(d).toLocaleString():"";return K(()=>{c()}),(l,e)=>{const d=s("el-icon"),v=s("el-input"),m=s("el-table-column"),f=s("el-button"),q=s("el-table"),F=s("el-pagination"),x=s("el-form-item"),M=s("el-form"),j=s("el-dialog"),H=O("loading");return A(),Q("div",re,[e[13]||(e[13]=p("div",{class:"page-header"},[p("h1",{class:"page-title"},"AI 用例管理")],-1)),p("div",ie,[p("div",de,[t(v,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a),placeholder:"搜索用例名称或描述",clearable:"",onInput:P,style:{width:"300px"}},{prefix:o(()=>[t(d,null,{default:o(()=>[t(C(Y))]),_:1})]),_:1},8,["modelValue"])]),W((A(),X(q,{data:V.value,style:{width:"100%"}},{default:o(()=>[t(m,{prop:"name",label:"用例名称","min-width":"200","show-overflow-tooltip":""}),t(m,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),t(m,{prop:"task_description",label:"任务描述","min-width":"300","show-overflow-tooltip":""}),t(m,{prop:"created_at",label:"创建时间",width:"180",formatter:$}),t(m,{label:"操作",width:"200",fixed:"right"},{default:o(({row:a})=>[t(f,{size:"small",type:"success",onClick:I=>T(a)},{default:o(()=>[t(d,null,{default:o(()=>[t(C(Z))]),_:1}),e[8]||(e[8]=g(" 执行 ",-1))]),_:2,__:[8]},1032,["onClick"]),t(f,{size:"small",type:"primary",onClick:I=>L(a)},{default:o(()=>[t(d,null,{default:o(()=>[t(C(ee))]),_:1}),e[9]||(e[9]=g(" 编辑 ",-1))]),_:2,__:[9]},1032,["onClick"]),t(f,{size:"small",type:"danger",onClick:I=>R(a.id)},{default:o(()=>[t(d,null,{default:o(()=>[t(C(te))]),_:1}),e[10]||(e[10]=g(" 删除 ",-1))]),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,y.value]]),p("div",ue,[t(F,{"current-page":r.currentPage,"onUpdate:currentPage":e[1]||(e[1]=a=>r.currentPage=a),"page-size":r.pageSize,"onUpdate:pageSize":e[2]||(e[2]=a=>r.pageSize=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:h.value,onSizeChange:E,onCurrentChange:D},null,8,["current-page","page-size","total"])])]),t(j,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=a=>_.value=a),title:"编辑 AI 用例",width:"600px"},{footer:o(()=>[p("span",ce,[t(f,{onClick:e[6]||(e[6]=a=>_.value=!1)},{default:o(()=>e[11]||(e[11]=[g("取消",-1)])),_:1,__:[11]}),t(f,{type:"primary",onClick:N,loading:b.value},{default:o(()=>e[12]||(e[12]=[g("保存",-1)])),_:1,__:[12]},8,["loading"])])]),default:o(()=>[t(M,{model:n,rules:B,ref_key:"editFormRef",ref:k,"label-width":"100px"},{default:o(()=>[t(x,{label:"用例名称",prop:"name"},{default:o(()=>[t(v,{modelValue:n.name,"onUpdate:modelValue":e[3]||(e[3]=a=>n.name=a),placeholder:"请输入用例名称"},null,8,["modelValue"])]),_:1}),t(x,{label:"描述",prop:"description"},{default:o(()=>[t(v,{modelValue:n.description,"onUpdate:modelValue":e[4]||(e[4]=a=>n.description=a),type:"textarea",placeholder:"请输入用例描述"},null,8,["modelValue"])]),_:1}),t(x,{label:"任务描述",prop:"task_description"},{default:o(()=>[t(v,{modelValue:n.task_description,"onUpdate:modelValue":e[5]||(e[5]=a=>n.task_description=a),type:"textarea",rows:6,placeholder:"请输入自然语言任务描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ge=J(pe,[["__scopeId","data-v-b909cdd6"]]);export{ge as default};
