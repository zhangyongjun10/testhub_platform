import{_ as E,q as c,v as Q,x as H,r as J,o as d,c as u,b as e,F as W,y as X,B as q,N as g,am as Y,A as I,t as v,f,O as M,ab as Z,P as ee,aa as se,G as x,z as ae,C as y,e as i,d as te}from"./index-054e2682.js";const le={class:"ai-mode-config"},oe={class:"main-content"},ne={class:"configs-section"},ie={class:"configs-grid"},de={class:"config-header"},ue={class:"config-title"},re={class:"config-badges"},ce={class:"model-name-badge"},ve={class:"config-actions"},me=["onClick","disabled"],pe={key:0},_e={key:1},ye=["onClick"],ge=["onClick"],fe={class:"config-details"},be={class:"detail-item"},he={class:"detail-item"},ke={key:0,class:"empty-state"},Ce={class:"modal-header"},we={class:"modal-body"},Ae={class:"form-group"},Ie={class:"form-group"},Me={class:"form-group"},xe={class:"form-group"},$e=["placeholder","required"],Ve={key:0,class:"form-hint"},qe={class:"form-group"},Ue={class:"form-group"},Se={class:"checkbox-label"},Be={class:"modal-actions"},ze={key:0},Fe={key:1},Ne=["disabled"],De={key:0},Ke={key:1},Oe={class:"modal-body"},Pe={class:"result-icon"},Le={class:"result-content"},Te={__name:"AIIntelligentModeConfig",setup(Ge){const k=c([]),$=c(!1),V=c(!1),p=c(!1),m=c(!1),C=c(!1),b=c(!1),w=c(null),r=c({success:!1,message:""}),t=c({name:"",model_type:"",model_name:"",api_key:"",base_url:"",is_active:!0}),U={openai:"https://api.openai.com/v1",azure_openai:"",anthropic:"https://api.anthropic.com",google_gemini:"",deepseek:"https://api.deepseek.com",siliconflow:"https://api.siliconflow.cn/v1",other:""},S=Q(()=>$.value||V.value),N=l=>({openai:"OpenAI",azure_openai:"Azure OpenAI",anthropic:"Anthropic",google_gemini:"Google Gemini",deepseek:"DeepSeek",siliconflow:"ç¡…åŸºæµåŠ¨",other:"å…¶ä»–"})[l]||l,A=async()=>{try{const l=await y.get("/ui-automation/ai-models/");l.data&&Array.isArray(l.data)&&(k.value=l.data.map(s=>({...s,toggling:!1,testing:!1})))}catch(l){console.error("åŠ è½½é…ç½®å¤±è´¥:",l),i.error("åŠ è½½é…ç½®å¤±è´¥")}},B=()=>{z(),m.value=!1,$.value=!0},z=()=>{t.value={name:"",model_type:"",model_name:"",api_key:"",base_url:"",is_active:!0}},D=l=>{m.value=!0,w.value=l.id;const s=Math.max(l.api_key_length||8,8),n="*".repeat(s);t.value={name:l.name,model_type:l.model_type,model_name:l.model_name,api_key:n,base_url:l.base_url,is_active:l.is_active},V.value=!0},K=()=>{U[t.value.model_type]&&(t.value.base_url=U[t.value.model_type]),t.value.model_type==="openai"&&!t.value.model_name?t.value.model_name="gpt-4o":t.value.model_type==="anthropic"&&!t.value.model_name?t.value.model_name="claude-3-5-sonnet-20241022":t.value.model_type==="deepseek"&&!t.value.model_name?t.value.model_name="deepseek-chat":t.value.model_type==="siliconflow"&&!t.value.model_name&&(t.value.model_name="Qwen/Qwen2.5-7B-Instruct")},O=async()=>{var n,a;const s=[{name:"name",value:t.value.name},{name:"model_type",value:t.value.model_type},{name:"model_name",value:t.value.model_name},{name:"api_key",value:t.value.api_key}].filter(o=>!o.value||typeof o.value=="string"&&o.value.trim()==="");if(s.length>0){i.error(`è¯·å¡«å†™ä»¥ä¸‹å¿…å¡«å­—æ®µ: ${s.map(o=>o.name).join(", ")}`);return}C.value=!0;try{const o={...t.value};if(m.value){(!o.api_key||o.api_key.includes("*"))&&delete o.api_key;const _=await y.put(`/ui-automation/ai-models/${w.value}/`,o);_.data.disabled_configs&&_.data.disabled_configs.length>0?i.success(`é…ç½®"${t.value.name}"å·²å¯ç”¨ï¼Œå·²è‡ªåŠ¨ç¦ç”¨ä»¥ä¸‹é…ç½®:
${_.data.disabled_configs.join("ã€")}`):i.success("é…ç½®æ›´æ–°æˆåŠŸ")}else{const _=await y.post("/ui-automation/ai-models/",o);_.data.disabled_configs&&_.data.disabled_configs.length>0?i.success(`é…ç½®"${t.value.name}"å·²æ·»åŠ å¹¶å¯ç”¨ï¼Œå·²è‡ªåŠ¨ç¦ç”¨ä»¥ä¸‹é…ç½®:
${_.data.disabled_configs.join("ã€")}`):i.success("é…ç½®æ·»åŠ æˆåŠŸ")}h(),await A()}catch(o){console.error("ä¿å­˜é…ç½®å¤±è´¥:",o),i.error("ä¿å­˜å¤±è´¥: "+(((a=(n=o.response)==null?void 0:n.data)==null?void 0:a.error)||o.message))}finally{C.value=!1}},P=async l=>{var s,n;if(confirm("ç¡®å®šè¦åˆ é™¤æ­¤é…ç½®å—ï¼Ÿ"))try{await y.delete(`/ui-automation/ai-models/${l}/`),i.success("é…ç½®åˆ é™¤æˆåŠŸ"),await A()}catch(a){console.error("åˆ é™¤é…ç½®å¤±è´¥:",a),i.error("åˆ é™¤å¤±è´¥: "+(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||a.message))}},L=async l=>{var s,n;if(l.is_active){const a=k.value.filter(o=>o.id!==l.id&&o.is_active);if(a.length>0){const o=a.map(j=>j.name).join("ã€");if(!confirm(`å¯ç”¨"${l.name}"å°†ä¼šè‡ªåŠ¨ç¦ç”¨ä»¥ä¸‹å·²å¯ç”¨çš„é…ç½®:

${o}

ç¡®å®šè¦ç»§ç»­å—?`)){l.is_active=!1;return}}}l.toggling=!0;try{await y.patch(`/ui-automation/ai-models/${l.id}/`,{is_active:l.is_active}),i.success(l.is_active?"é…ç½®å·²å¯ç”¨":"é…ç½®å·²ç¦ç”¨"),await A()}catch(a){console.error("åˆ‡æ¢çŠ¶æ€å¤±è´¥:",a),i.error("æ“ä½œå¤±è´¥: "+(((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||a.message)),l.is_active=!l.is_active}finally{l.toggling=!1}},T=async l=>{var s,n;l.testing=!0;try{await y.post(`/ui-automation/ai-models/${l.id}/test_connection/`),r.value={success:!0,message:"è¿æ¥æˆåŠŸï¼æ¨¡å‹é…ç½®æ­£å¸¸å·¥ä½œã€‚"},p.value=!0}catch(a){console.error("æµ‹è¯•è¿æ¥å¤±è´¥:",a),r.value={success:!1,message:((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||a.message||"è¿æ¥æµ‹è¯•å¤±è´¥"},p.value=!0}finally{l.testing=!1}},G=async()=>{var l,s,n,a;if(!t.value.api_key){i.warning("è¯·å…ˆè¾“å…¥API Key");return}if(!t.value.model_type||!t.value.model_name){i.warning("è¯·å…ˆé€‰æ‹©æ¨¡å‹æä¾›å•†å’Œæ¨¡å‹åç§°");return}if(m.value&&t.value.api_key.includes("*")){b.value=!0;try{await y.post(`/ui-automation/ai-models/${w.value}/test_connection/`),r.value={success:!0,message:"è¿æ¥æˆåŠŸï¼æ¨¡å‹é…ç½®æ­£å¸¸å·¥ä½œã€‚"},p.value=!0}catch(o){console.error("æµ‹è¯•è¿æ¥å¤±è´¥:",o),r.value={success:!1,message:((s=(l=o.response)==null?void 0:l.data)==null?void 0:s.error)||o.message||"è¿æ¥æµ‹è¯•å¤±è´¥"},p.value=!0}finally{b.value=!1}return}b.value=!0;try{await y.post("/ui-automation/ai-models/test_connection/",{provider:t.value.model_type,model_name:t.value.model_name,api_key:t.value.api_key,base_url:t.value.base_url}),r.value={success:!0,message:"è¿æ¥æˆåŠŸï¼æ¨¡å‹é…ç½®æ­£å¸¸å·¥ä½œã€‚"},p.value=!0}catch(o){console.error("æµ‹è¯•è¿æ¥å¤±è´¥:",o),r.value={success:!1,message:((a=(n=o.response)==null?void 0:n.data)==null?void 0:a.error)||o.message||"è¿æ¥æµ‹è¯•å¤±è´¥"},p.value=!0}finally{b.value=!1}},h=()=>{$.value=!1,V.value=!1,m.value=!1,w.value=null,z()},F=()=>{p.value=!1},R=l=>l?new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return H(()=>{A()}),(l,s)=>{const n=J("el-switch");return d(),u("div",le,[s[26]||(s[26]=e("div",{class:"page-header"},[e("h1",null,"ğŸ§  AIæ™ºèƒ½æ¨¡å¼é…ç½®"),e("p",null,"é…ç½®Browser-useæ‰§è¡Œæ—¶çš„æ™ºèƒ½æ¨¡å¼ä¸æ¨¡å‹å‚æ•°")],-1)),e("div",oe,[e("div",ne,[e("div",{class:"section-header"},[s[8]||(s[8]=e("h2",null,"é…ç½®åˆ—è¡¨",-1)),e("button",{class:"add-config-btn",onClick:B}," â• æ·»åŠ é…ç½® ")]),e("div",ie,[(d(!0),u(W,null,X(k.value,a=>(d(),u("div",{key:a.id,class:"config-card"},[e("div",de,[e("div",ue,[e("h3",null,v(a.name||"æœªå‘½åé…ç½®"),1),e("div",re,[e("span",{class:x(["provider-badge",a.model_type])},v(N(a.model_type)),3),e("span",ce,v(a.model_name),1),e("span",{class:x(["status-badge",{active:a.is_active}])},v(a.is_active?"å·²å¯ç”¨":"å·²ç¦ç”¨"),3)])]),e("div",ve,[te(n,{modelValue:a.is_active,"onUpdate:modelValue":o=>a.is_active=o,onChange:o=>L(a),"active-text":"å¯ç”¨","inactive-text":"ç¦ç”¨",loading:a.toggling},null,8,["modelValue","onUpdate:modelValue","onChange","loading"]),e("button",{class:"test-btn",onClick:o=>T(a),disabled:a.testing},[a.testing?(d(),u("span",pe,"ğŸ”„")):(d(),u("span",_e,"ğŸ”—")),s[9]||(s[9]=f(" æµ‹è¯•è¿æ¥ ",-1))],8,me),e("button",{class:"edit-btn",onClick:o=>D(a)},"âœï¸",8,ye),e("button",{class:"delete-btn",onClick:o=>P(a.id)},"ğŸ—‘ï¸",8,ge)])]),e("div",fe,[e("div",be,[s[10]||(s[10]=e("label",null,"Base URL:",-1)),e("span",null,v(a.base_url||"æœªè®¾ç½®"),1)]),e("div",he,[s[11]||(s[11]=e("label",null,"åˆ›å»ºæ—¶é—´:",-1)),e("span",null,v(R(a.created_at)),1)])])]))),128))]),k.value.length===0?(d(),u("div",ke,[s[12]||(s[12]=e("div",{class:"empty-icon"},"ğŸ§ ",-1)),s[13]||(s[13]=e("h3",null,"æš‚æ— AIæ™ºèƒ½æ¨¡å¼é…ç½®",-1)),s[14]||(s[14]=e("p",null,"è¯·æ·»åŠ æ‚¨çš„AIæ¨¡å‹é…ç½®ä»¥å¼€å§‹ä½¿ç”¨æ™ºèƒ½æ¨¡å¼",-1)),e("button",{class:"add-first-config-btn",onClick:B}," â• æ·»åŠ ç¬¬ä¸€ä¸ªé…ç½® ")])):q("",!0)])]),g(e("div",{class:x(["config-modal",{hidden:!S.value}]),onClick:h,onKeydown:ae(h,["esc"])},[e("div",{class:"modal-content",onClick:s[6]||(s[6]=I(()=>{},["stop"]))},[e("div",Ce,[e("h3",null,v(m.value?"ç¼–è¾‘":"æ·»åŠ ")+"AIæ™ºèƒ½æ¨¡å¼é…ç½®",1),e("button",{class:"close-btn",onClick:I(h,["stop"]),type:"button"},"Ã—")]),e("div",we,[e("form",{onSubmit:I(O,["prevent"])},[e("div",Ae,[s[15]||(s[15]=e("label",null,[f("é…ç½®åç§° "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.value.name=a),type:"text",class:"form-input",placeholder:"ä¾‹å¦‚ï¼šOpenAIæ™ºèƒ½æ¨¡å¼",required:""},null,512),[[M,t.value.name]])]),e("div",Ie,[s[17]||(s[17]=e("label",null,[f("æ¨¡å‹æä¾›å•† "),e("span",{class:"required"},"*")],-1)),g(e("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.model_type=a),class:"form-select",required:"",onChange:K},s[16]||(s[16]=[Z('<option value="" data-v-672d3466>è¯·é€‰æ‹©æä¾›å•†</option><option value="openai" data-v-672d3466>OpenAI</option><option value="azure_openai" data-v-672d3466>Azure OpenAI</option><option value="anthropic" data-v-672d3466>Anthropic</option><option value="google_gemini" data-v-672d3466>Google Gemini</option><option value="deepseek" data-v-672d3466>DeepSeek</option><option value="siliconflow" data-v-672d3466>ç¡…åŸºæµåŠ¨ (SiliconFlow)</option><option value="other" data-v-672d3466>å…¶ä»– (Other)</option>',8)]),544),[[ee,t.value.model_type]])]),e("div",Me,[s[18]||(s[18]=e("label",null,[f("æ¨¡å‹åç§° "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>t.value.model_name=a),type:"text",class:"form-input",placeholder:"ä¾‹å¦‚: gpt-4o, claude-3-5-sonnet",required:""},null,512),[[M,t.value.model_name]])]),e("div",xe,[s[19]||(s[19]=e("label",null,[f("API Key "),e("span",{class:"required"},"*")],-1)),g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>t.value.api_key=a),type:"password",class:"form-input",placeholder:m.value?"ä¸ä¿®æ”¹è¯·ä¿æŒåŸå€¼ä¸å˜ï¼Œå¡«å†™æ–°å€¼åˆ™æ›´æ–°":"è¾“å…¥æ‚¨çš„API Key",required:!m.value},null,8,$e),[[M,t.value.api_key]]),m.value&&t.value.api_key&&t.value.api_key.includes("*")?(d(),u("small",Ve,' å½“å‰æ˜¾ç¤ºçš„æ˜¯æ©ç æ ¼å¼ã€‚å¦‚éœ€ä¿®æ”¹è¯·è¾“å…¥æ–°çš„API Keyï¼Œå¦‚ä¸ä¿®æ”¹å¯ç›´æ¥ç‚¹å‡»"æµ‹è¯•è¿æ¥"æµ‹è¯•ç°æœ‰é…ç½® ')):q("",!0)]),e("div",qe,[s[20]||(s[20]=e("label",null,"Base URL",-1)),g(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>t.value.base_url=a),type:"url",class:"form-input",placeholder:"å¯é€‰ï¼Œä¾‹å¦‚: https://api.openai.com/v1"},null,512),[[M,t.value.base_url]]),s[21]||(s[21]=e("small",{class:"form-hint"}," é€‰æ‹©æä¾›å•†åä¼šè‡ªåŠ¨å¡«å……å¯¹åº”çš„APIåœ°å€ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ ",-1))]),e("div",Ue,[e("label",Se,[g(e("input",{"onUpdate:modelValue":s[5]||(s[5]=a=>t.value.is_active=a),type:"checkbox"},null,512),[[se,t.value.is_active]]),s[22]||(s[22]=e("span",{class:"checkmark"},null,-1)),s[23]||(s[23]=f(" å¯ç”¨æ­¤é…ç½® ",-1))]),s[24]||(s[24]=e("small",{class:"form-hint"}," å¯ç”¨åï¼Œå…¶ä»–å·²å¯ç”¨çš„é…ç½®å°†è‡ªåŠ¨ç¦ç”¨ ",-1))]),e("div",Be,[e("button",{type:"button",class:"cancel-btn",onClick:h},"å–æ¶ˆ"),e("button",{type:"button",class:"test-btn-form",onClick:G},[b.value?(d(),u("span",ze,"ğŸ”„ æµ‹è¯•ä¸­...")):(d(),u("span",Fe,"ğŸ”— æµ‹è¯•è¿æ¥"))]),e("button",{type:"submit",class:"confirm-btn",disabled:C.value},[C.value?(d(),u("span",De,"ğŸ”„ ä¿å­˜ä¸­...")):(d(),u("span",Ke,"ğŸ’¾ ä¿å­˜é…ç½®"))],8,Ne)])],32)])])],34),[[Y,S.value]]),p.value?(d(),u("div",{key:0,class:"test-result-modal",onClick:F},[e("div",{class:"modal-content",onClick:s[7]||(s[7]=I(()=>{},["stop"]))},[e("div",{class:"modal-header"},[s[25]||(s[25]=e("h3",null,"è¿æ¥æµ‹è¯•ç»“æœ",-1)),e("button",{class:"close-btn",onClick:F},"Ã—")]),e("div",Oe,[e("div",{class:x(["test-result",{success:r.value.success,error:!r.value.success}])},[e("div",Pe,v(r.value.success?"âœ…":"âŒ"),1),e("div",Le,[e("h4",null,v(r.value.success?"è¿æ¥æˆåŠŸ":"è¿æ¥å¤±è´¥"),1),e("p",null,v(r.value.message),1)])],2)])])])):q("",!0)])}}},je=E(Te,[["__scopeId","data-v-672d3466"]]);export{je as default};
