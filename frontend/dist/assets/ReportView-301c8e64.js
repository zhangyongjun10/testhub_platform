import{_ as M,q as f,x as k,r as c,S as A,o as y,c as I,b as n,d as s,w as a,N as L,J as q,C as m,e as p,f as i,t as _,R as V}from"./index-054e2682.js";const T={class:"report-view"},B={class:"header"},G={class:"actions"},P={class:"content"},S={style:{color:"#67c23a"}},Y={style:{color:"#f56c6c"}},$={__name:"ReportView",setup(O){const u=f([]),d=f(!1),w=async()=>{d.value=!0;try{const e=await m.get("/api-testing/test-executions/");u.value=e.data.results||e.data}catch{p.error("加载测试报告失败")}finally{d.value=!1}},b=async()=>{await w()},v=async e=>{try{const t=await m.post(`/api-testing/test-executions/${e}/generate-allure-report/`);p.success("报告生成成功");const l=`${window.location.origin}${t.data.report_url}`;window.open(l,"_blank")}catch{p.error("生成报告失败")}},g=()=>{p.info('请先在下方表格中选择一个测试执行记录，然后点击"生成并查看报告"按钮来生成并查看详细的测试报告')},h=e=>{v(e.id)},D=e=>({PENDING:"info",RUNNING:"warning",COMPLETED:"success",FAILED:"danger",CANCELLED:"info"})[e]||"info",N=e=>({PENDING:"待执行",RUNNING:"执行中",COMPLETED:"已完成",FAILED:"执行失败",CANCELLED:"已取消"})[e]||e,E=e=>V(e).format("YYYY-MM-DD HH:mm:ss");return k(()=>{w()}),(e,t)=>{const l=c("el-button"),r=c("el-table-column"),x=c("el-tag"),C=c("el-table"),R=A("loading");return y(),I("div",T,[n("div",B,[t[2]||(t[2]=n("h3",null,"测试报告",-1)),n("div",G,[s(l,{type:"primary",onClick:b},{default:a(()=>t[0]||(t[0]=[i("刷新报告",-1)])),_:1,__:[0]}),s(l,{onClick:g},{default:a(()=>t[1]||(t[1]=[i("查看Allure报告说明",-1)])),_:1,__:[1]})])]),n("div",P,[L((y(),q(C,{data:u.value,style:{width:"100%"}},{default:a(()=>[s(r,{prop:"id",label:"ID",width:"80"}),s(r,{prop:"test_suite_name",label:"测试套件","min-width":"200"}),s(r,{prop:"status",label:"状态",width:"120"},{default:a(o=>[s(x,{type:D(o.row.status)},{default:a(()=>[i(_(N(o.row.status)),1)]),_:2},1032,["type"])]),_:1}),s(r,{prop:"total_requests",label:"总请求数",width:"100"}),s(r,{prop:"passed_requests",label:"通过数",width:"100"},{default:a(o=>[n("span",S,_(o.row.passed_requests),1)]),_:1}),s(r,{prop:"failed_requests",label:"失败数",width:"100"},{default:a(o=>[n("span",Y,_(o.row.failed_requests),1)]),_:1}),s(r,{prop:"executed_by.username",label:"执行者",width:"120"}),s(r,{prop:"created_at",label:"执行时间",width:"180"},{default:a(o=>[i(_(E(o.row.created_at)),1)]),_:1}),s(r,{label:"操作",width:"150"},{default:a(o=>[s(l,{link:"",type:"primary",onClick:U=>h(o.row)},{default:a(()=>t[3]||(t[3]=[i("生成并查看报告",-1)])),_:2,__:[3]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,d.value]])])])}}},H=M($,[["__scopeId","data-v-20a6bce7"]]);export{H as default};
